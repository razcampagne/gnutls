From 1e013f4c660fa79c2398dbcfd4f0e054c724c5ec Mon Sep 17 00:00:00 2001
From: Nikos Mavrogiannopoulos <nmav@gnutls.org>
Date: Sat, 25 Apr 2015 19:14:07 +0200
Subject: [PATCH 1/3] _gnutls_session_sign_algo_enabled: do not consider any
 values from the extension data to decide acceptable algorithms

---
 lib/ext/signature.c | 18 +-----------------
 1 file changed, 1 insertion(+), 17 deletions(-)

Index: gnutls-2.12.23/lib/ext_signature.c
===================================================================
--- gnutls-2.12.23.orig/lib/ext_signature.c
+++ gnutls-2.12.23/lib/ext_signature.c
@@ -379,28 +379,11 @@ _gnutls_session_sign_algo_enabled (gnutl
                                    gnutls_sign_algorithm_t sig)
 {
   unsigned i;
-  int ret;
   gnutls_protocol_t ver = gnutls_protocol_get_version (session);
-  sig_ext_st *priv;
-  extension_priv_data_t epriv;
 
-  ret =
-    _gnutls_ext_get_session_data (session,
-                                  GNUTLS_EXTENSION_SIGNATURE_ALGORITHMS,
-                                  &epriv);
-  if (ret < 0)
-    {
-      gnutls_assert ();
-      return 0;
-    }
-  priv = epriv.ptr;
-
-  if (!_gnutls_version_has_selectable_sighash (ver)
-      || priv->sign_algorithms_size == 0)
-    /* none set, allow all */
-    {
-      return 0;
-    }
+  if (!_gnutls_version_has_selectable_sighash(ver)) {
+    return 0;
+  }
 
   for (i = 0; i < session->internals.priorities.sign_algo.algorithms; i++)
     {
